This code was copied over with many thanks from https://github.com/stellar/go/blob/master/exp/crypto/derivation/main.go

